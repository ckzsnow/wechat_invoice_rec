var data={"other_details":"","person_support_relationship":"","organisation_support_address":"NO 189 FANGJIADAI ROAD","sponsor_birth_date":"","business_activity_contact_family_name":"JACK","hold_visa_detail":"America,Germany,India","self_employed_organisation_suburb_town":"HANGZHOU","sponsor_issue_place":"","business_activity_suburb_town":"xxxxx","travel_document":"E:\\data\\countries\\australia\\18b62e3c209d42e3972d1c237e82af0f_australia.pdf","student_date_to":"","person_support_type":"","self_employed_organisation_address":"NO 189 FANGJIADAI ROAD","organisation_support_type":"3","person_support_suburb_town":"","funded_way":"3","self_employed_occupation_grouping":"","sponsor_business_phone":"","self_employed_organisation_state_province":"ZJ","sponsor_given_names":"","self_employed_organisation_cell_phone":"057188237000","has_other_identify_document":"2","not_compiled_with_visa_conditions":"2","business_activity_date_from":"xxxx","sponsor_home_phone":"","login_username":"261831845@qq.com","lodgement_num":"","sponsor_nationality":"","employer_support_detail_fund":"","self_employed_organisation_address_2":"GONGSHU DISTRICT","national_id_card":"E:\\data\\countries\\australia\\2fc819357e9b420eacf34d14168c6f2f_australia.pdf","business_activity_postcode":"0000","person_support_address_2":"","employed_organisation":"Hangzhou Zhongya Machinery CO Ltd","has_contacts":"2","employed_organisation_cell_phone":"057188237000","unemployed_last_position":"","stay_purpose":"1","business_activity_address_2":"xxxx","employed_organisation_business_phone":"057188237000","residential_suburb_town":"HANGZHOU","employed_organisation_address":"NO 189 FANGJIADAI ROAD","task_id":"329","person_support_address":"","family_composition":"E:\\data\\countries\\australia\\c013878076ad43d99ec60c1e9ad1da7b_australia.pdf","stay_length":"3","visit_outside_history":[],"sponsor_res_address_2":"","financial_capacity_bankstatement":"E:\\data\\countries\\australia\\1ea0f7b7354940e3975257990a4892f9_australia.pdf","issue_date":"04 DEC 2009","sponsor_sex":"","sponsor_issue_date":"","orther_document":{"orther_document_document_type":"","orther_document_family_name":"","orther_document_given_names":"","orther_document_issue_country":"","orther_document_identification_number":""},"compiled_details":"","sponsor_has_passport":"","employed_organisation_suburb_town":"HANGZHOU","organisation_support_country":"PRCH","retired_date":"","sponsor_cell_phone":"","business_activity_date_to":"xxxxx","invitation_sponsor":"E:\\data\\countries\\australia\\cf2cd9d2c86b432188a6d0a0bb7a422b_australia.pdf","previous_travel":"E:\\data\\countries\\australia\\e780cd2b480042c0a91994ed3058071b_australia.pdf","student_course_name":"","organisation_support_suburb_town":"HANGZHOU","business_activity_state":"ACT","sex":"M","expiry_date":"03 DEC 2019","residential_state_province":"ZJ","person_support_country":"","given_name":"YANJING","self_employed_organisation_country":"PRCH","employed_start_date":"13 Jan 2017","attachFilesList":[{"btnName":"Photograph - Passport","fileIdentifier":"photograph_passport","description":"yuyanjing","document_type":""},{"btnName":"National ID Card","fileIdentifier":"national_id_card","description":"yuyanjing","document_type":""},{"btnName":"Travel Document","fileIdentifier":"travel_document","description":"yuyanjing","document_type":"DT366"},{"btnName":"Family Composition, Evidence of","fileIdentifier":"family_composition","description":"yuyanjing","document_type":"DT053"},{"btnName":"Financial Capacity - Personal, Evidence of","fileIdentifier":"financial_capacity_bankstatement","description":"yuyanjing","document_type":"DT127"},{"btnName":"Invitation, Evidence of","fileIdentifier":"invitation_sponsor","description":"yuyanjing","document_type":"DT110"},{"btnName":"Employment - Current, Evidence of","fileIdentifier":"employment_current","description":"yuyanjing","document_type":"DT134"},{"btnName":"Employment - Current, Evidence of","fileIdentifier":"employment_licence","description":"yuyanjing","document_type":"DT015"},{"btnName":"Previous Travel, Evidence of","fileIdentifier":"previous_travel","description":"yuyanjing","document_type":"DT127"}],"has_identify_card":"1","employed_organisation_address_2":"GONGSHU DISTRICT","other_person":[],"email_address":"2880847958@qq.com","sponsor_postal_code":"","birth_state_province":"ZHEJIANG","business_activity_contact_given_names":"MA","employed_occupation":"Sales","employer_support_type":"","postal_code":"453000","task_type":"australia","business_activity_organisation":"悉尼大学","department_office":"China, Shanghai","contacts":[],"residential_address":"No 63 garden new village","hold_visa_to_australia_other_country":"1","invitation_business":"E:\\data\\countries\\australia\\efe51c1675754fff8bbb344370d8e37a_australia.pdf","applying_stream":"31","birth_date":"03 NOV 1976","student_institution_name":"","self_employed_organisation_postcode":"310011","birth_country":"PRCH","employed_organisation_email_address":"sales@zhongyagroup.com","business_activity_contact_business_phone":"110","person_support_postal_code":"","relationship_status":"M","login_password":"Lb3283888","person_support_given_names":"","sponsor_expiry_date":"","employment_current":"E:\\data\\countries\\australia\\b5a91df8b72f4e1380ae16632038ed15_australia.pdf","home_phone":"","sponsor_res_state":"","visit_reasons":"2","refused_details":"","employed_organisation_country":"PRCH","organisation_support_address_2":"GONGSHU DISTRICT","organisation_support_state_province":"ZJ","self_employed_organisation":"Hangzhou Zhongya Machinery CO Ltd","business_activity_details":"IT大会","other_names":{"other_names_change_details":"","other_names_change_reason":"","other_namse_given_name":"","other_names_family_name":""},"person_support_detail_fund":"","sponsor_ppt_country":"","employed_occupation_grouping":"6","business_activity_address":"xxxx","employment_licence":"E:\\data\\countries\\australia\\9ac0d0e7a3b54549af2407ce572f1646_australia.pdf","birth_town_city":"KAIHUA","unemployed_date_from":"","business_activity_email_address":"XXXX@QQ.COM","priority_fee":"2","has_had_a_refused_visa":"2","self_employed_occupation":"","business_activity_contact_position":"PRESIDENT","residential_address_2":"liangzhu town hangzhou","organisation_support_postal_code":"310011","student_date_from":"","self_employed_start_date":"08 FEB 1999","person_support_family_name":"","has_other_person_travelling_with":"2","mobile_cell_phone":"13819109134","sponsor_family_name":"","sponsor_relationship":"","business_activity_location":"悉尼","business_phone":"057188237000","to_date":"20 Mar 2018","sponsor_ppt_num":"","passport_country":"CHN","sponsor_res_address":"","family_members":[{"family_members_family_name":"ZHANG","family_members_given_names":"XIUJUAN","family_members_relationship":"3","family_members_birth_country":"PRCH","family_members_sex":"F","family_members_birth_date":"16 AUG 1975"},{"family_members_family_name":"YU","family_members_given_names":"LINQIN","family_members_relationship":"2","family_members_birth_country":"PRCH","family_members_sex":"M","family_members_birth_date":"27 MAY 1953"},{"family_members_family_name":"XU","family_members_given_names":"JIAODI","family_members_relationship":"2","family_members_birth_country":"PRCH","family_members_sex":"F","family_members_birth_date":"20 AUG 1955"}],"employed_organisation_postcode":"310011","task_excel_file_path":"E:\\data\\countries\\australia\\e2a3da17800b4536b9bf7c92ec5a2380_australia.xls","employment_status":"1","has_other_names":"2","identify_card_details":{"identify_card_identification_num":"330824197611036815","identify_card_issue_date":"13 Feb 2018","identify_card_expiry_date":"13 Feb 2028","identify_card_family_name":"YU","identify_card_given_names":"YANJING"},"date_detail":"From 10 MAR,2018 to 20 MAR,2018","business_activity_contact_cell_phone":"100000000","issue_place":"ZJ","from_date":"10 Mar 2018","person_support_state_province":"","has_other_family_members":"1","has_visited_lived_outside":"2","organisation_support_detail_fund":"cash","employed_organisation_state_province":"ZJ","business_activity_intend":"1","photograph_passport":"E:\\data\\countries\\australia\\7ebabc96f3a1467db299ed7f9fc6fbf8_australia.jpg","passport_number":"G38934749","self_employed_organisation_email_address":"sales@zhongyagroup.com","sponsor_res_suburb_town":"","self_funded_detail_fund":"cash","family_name":"YU","self_employed_organisation_business_phone":"057188237000"};function currentStepFinish(callback){window.cefQuery({request: 'CurrentStepFinish:',onSuccess: function(response) {callback();},onFailure: function(error_code, error_message) {callback();}});}function isHidden(obj) {var style = null;if(window.getComputedStyle){style = window.getComputedStyle(obj, null);} else {style = obj.currentStyle;}return (style.width=='auto');}function skipStep(callback){window.cefQuery({request: 'SkipStep:',onSuccess: function(response) {callback();},onFailure: function(error_code, error_message) {callback();}});}function getFamilyInfo(callback){window.cefQuery({request: 'getFamilyInfo:',onSuccess: function(response) {console.log('familyMemberInfo json : ' + response);var familyMemberInfo = {};if(response == null || response == '') {callback(null);} else {familyMemberInfo = JSON.parse(response);callback(familyMemberInfo);}},onFailure: function(error_code, error_message) {callback(null);}});}function findAddBtn(){var spans = document.querySelectorAll('span');var button;for(var index in spans){if(spans[index].innerHTML == 'Non-accompanying members of the family unit') {var div = spans[index].parentNode.parentNode.parentNode.parentNode.parentNode;button = div.children[2].children[0].children[1];}}return button;}console.log(findAddBtn());var interval = setInterval(function(){if(document.querySelector('.ELP-F2143') != null && !isHidden(document.querySelector('.ELP-F2143'))) {clearInterval(interval);document.querySelector('.ELP-F2143').querySelector('input[value=\"'+data.has_other_family_members+'\"]').click();if(data.has_other_family_members == '1'){getFamilyInfo(function(obj){if(obj == null) {skipStep(function(){console.log('step9a skip');});} else {var interval2 = setInterval(function(){var btn = findAddBtn();if(!isHidden(btn) {clearInterval(interval2);currentStepFinish(function(){document.querySelector('.wc-panel-type-box .wc-button').click();});}}, 2000);}});} else {skipStep(function(){console.log('step9a skip');});}}}, 2000);